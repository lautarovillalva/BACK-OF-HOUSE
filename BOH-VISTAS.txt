USE [BACK OF HOUSE]
GO
CREATE VIEW [dbo].[VW_GRILLA]
AS
SELECT * 
FROM GRILLA

CREATE VIEW [dbo].[VW_PEDIDOS]
AS
SELECT
	PEDIDOS.ID,
	PEDIDOS.CUIT_PROVEEDOR,
	PEDIDOS.FECHA_INICIO,
	PEDIDOS.CANTIDAD
FROM PEDIDOS
WHERE PEDIDOS.ENTREGADO=0 OR PEDIDOS.ENTREGADO IS NULL

CREATE VIEW [dbo].[VW_PEDIDOS_RECIBIDOS]
AS
SELECT
	PEDIDOS.ID,
	PEDIDOS.CUIT_PROVEEDOR,
	PEDIDOS.FECHA_INICIO,
	PEDIDOS.FECHA_ENTREGA,
	PEDIDOS.CANTIDAD
FROM PEDIDOS
WHERE PEDIDOS.ENTREGADO=1

CREATE VIEW [dbo].[VW_PRODUCTO_MAS_VENDIDO]
AS
SELECT TOP 1 WITH TIES
	PRODUCTOS.UPC,
	PRODUCTOS.DESCRIPCION,
	ISNULL(SUM(PRODUCTOS_X_VENTA.CANTIDAD),0) AS 'CANTIDAD VENDIDA'
FROM PRODUCTOS
INNER JOIN PRODUCTOS_X_VENTA ON PRODUCTOS_X_VENTA.UPC=PRODUCTOS.UPC
GROUP BY PRODUCTOS.UPC, PRODUCTOS.DESCRIPCION
ORDER BY [CANTIDAD VENDIDA]

CREATE VIEW [dbo].[VW_PRODUCTOS_STOCKMIN]
AS
SELECT *
FROM PRODUCTOS
WHERE PRODUCTOS.STOCK<=PRODUCTOS.STOCK_MIN


