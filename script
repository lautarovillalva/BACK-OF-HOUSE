USE [master]
GO
/****** Object:  Database [BACK OF HOUSE]    Script Date: 25/12/2020 15:49:36 ******/
CREATE DATABASE [BACK OF HOUSE]
 CONTAINMENT = NONE
 ON  PRIMARY 
( NAME = N'BACK OF HOUSE', FILENAME = N'C:\Program Files\Microsoft SQL Server\MSSQL15.SQLEXPRESS\MSSQL\DATA\BACK OF HOUSE.mdf' , SIZE = 8192KB , MAXSIZE = UNLIMITED, FILEGROWTH = 65536KB )
 LOG ON 
( NAME = N'BACK OF HOUSE_log', FILENAME = N'C:\Program Files\Microsoft SQL Server\MSSQL15.SQLEXPRESS\MSSQL\DATA\BACK OF HOUSE_log.ldf' , SIZE = 8192KB , MAXSIZE = 2048GB , FILEGROWTH = 65536KB )
 WITH CATALOG_COLLATION = DATABASE_DEFAULT
GO
ALTER DATABASE [BACK OF HOUSE] SET COMPATIBILITY_LEVEL = 150
GO
IF (1 = FULLTEXTSERVICEPROPERTY('IsFullTextInstalled'))
begin
EXEC [BACK OF HOUSE].[dbo].[sp_fulltext_database] @action = 'enable'
end
GO
ALTER DATABASE [BACK OF HOUSE] SET ANSI_NULL_DEFAULT OFF 
GO
ALTER DATABASE [BACK OF HOUSE] SET ANSI_NULLS OFF 
GO
ALTER DATABASE [BACK OF HOUSE] SET ANSI_PADDING OFF 
GO
ALTER DATABASE [BACK OF HOUSE] SET ANSI_WARNINGS OFF 
GO
ALTER DATABASE [BACK OF HOUSE] SET ARITHABORT OFF 
GO
ALTER DATABASE [BACK OF HOUSE] SET AUTO_CLOSE ON 
GO
ALTER DATABASE [BACK OF HOUSE] SET AUTO_SHRINK OFF 
GO
ALTER DATABASE [BACK OF HOUSE] SET AUTO_UPDATE_STATISTICS ON 
GO
ALTER DATABASE [BACK OF HOUSE] SET CURSOR_CLOSE_ON_COMMIT OFF 
GO
ALTER DATABASE [BACK OF HOUSE] SET CURSOR_DEFAULT  GLOBAL 
GO
ALTER DATABASE [BACK OF HOUSE] SET CONCAT_NULL_YIELDS_NULL OFF 
GO
ALTER DATABASE [BACK OF HOUSE] SET NUMERIC_ROUNDABORT OFF 
GO
ALTER DATABASE [BACK OF HOUSE] SET QUOTED_IDENTIFIER OFF 
GO
ALTER DATABASE [BACK OF HOUSE] SET RECURSIVE_TRIGGERS OFF 
GO
ALTER DATABASE [BACK OF HOUSE] SET  ENABLE_BROKER 
GO
ALTER DATABASE [BACK OF HOUSE] SET AUTO_UPDATE_STATISTICS_ASYNC OFF 
GO
ALTER DATABASE [BACK OF HOUSE] SET DATE_CORRELATION_OPTIMIZATION OFF 
GO
ALTER DATABASE [BACK OF HOUSE] SET TRUSTWORTHY OFF 
GO
ALTER DATABASE [BACK OF HOUSE] SET ALLOW_SNAPSHOT_ISOLATION OFF 
GO
ALTER DATABASE [BACK OF HOUSE] SET PARAMETERIZATION SIMPLE 
GO
ALTER DATABASE [BACK OF HOUSE] SET READ_COMMITTED_SNAPSHOT OFF 
GO
ALTER DATABASE [BACK OF HOUSE] SET HONOR_BROKER_PRIORITY OFF 
GO
ALTER DATABASE [BACK OF HOUSE] SET RECOVERY SIMPLE 
GO
ALTER DATABASE [BACK OF HOUSE] SET  MULTI_USER 
GO
ALTER DATABASE [BACK OF HOUSE] SET PAGE_VERIFY CHECKSUM  
GO
ALTER DATABASE [BACK OF HOUSE] SET DB_CHAINING OFF 
GO
ALTER DATABASE [BACK OF HOUSE] SET FILESTREAM( NON_TRANSACTED_ACCESS = OFF ) 
GO
ALTER DATABASE [BACK OF HOUSE] SET TARGET_RECOVERY_TIME = 60 SECONDS 
GO
ALTER DATABASE [BACK OF HOUSE] SET DELAYED_DURABILITY = DISABLED 
GO
ALTER DATABASE [BACK OF HOUSE] SET QUERY_STORE = OFF
GO
USE [BACK OF HOUSE]
GO
/****** Object:  UserDefinedFunction [dbo].[VENTA_X_ID]    Script Date: 25/12/2020 15:49:37 ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
CREATE FUNCTION [dbo].[VENTA_X_ID]
(
@ID_VENTA BIGINT
)
RETURNS MONEY
AS
BEGIN
	DECLARE @TOTAL MONEY
	SET @TOTAL=
	(SELECT
	ISNULL(SUM(PRODUCTOS_X_VENTA.PRECIO_UNITARIO),0)
	FROM PRODUCTOS_X_VENTAS
	INNER JOIN VENTAS ON PRODUCTOS_X_VENTA.ID_VENTA=VENTAS.ID
	)
	RETURN @TOTAL
END;
GO
/****** Object:  Table [dbo].[PRODUCTOS]    Script Date: 25/12/2020 15:49:37 ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
CREATE TABLE [dbo].[PRODUCTOS](
	[UPC] [bigint] IDENTITY(1000,100) NOT NULL,
	[DESCRIPCION] [varchar](50) NOT NULL,
	[ID_COLOR] [int] NOT NULL,
	[ID_TALLE] [tinyint] NOT NULL,
	[STOCK] [int] NOT NULL,
	[STOCK_MIN] [int] NULL,
	[PRECIO] [money] NOT NULL,
	[ID_GENERO] [tinyint] NOT NULL,
PRIMARY KEY CLUSTERED 
(
	[UPC] ASC
)WITH (PAD_INDEX = OFF, STATISTICS_NORECOMPUTE = OFF, IGNORE_DUP_KEY = OFF, ALLOW_ROW_LOCKS = ON, ALLOW_PAGE_LOCKS = ON, OPTIMIZE_FOR_SEQUENTIAL_KEY = OFF) ON [PRIMARY]
) ON [PRIMARY]
GO
/****** Object:  Table [dbo].[PRODUCTOS_X_VENTA]    Script Date: 25/12/2020 15:49:37 ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
CREATE TABLE [dbo].[PRODUCTOS_X_VENTA](
	[ID_VENTA] [bigint] NOT NULL,
	[UPC] [bigint] NOT NULL,
	[PRECIO_UNITARIO] [money] NOT NULL,
PRIMARY KEY CLUSTERED 
(
	[ID_VENTA] ASC,
	[UPC] ASC
)WITH (PAD_INDEX = OFF, STATISTICS_NORECOMPUTE = OFF, IGNORE_DUP_KEY = OFF, ALLOW_ROW_LOCKS = ON, ALLOW_PAGE_LOCKS = ON, OPTIMIZE_FOR_SEQUENTIAL_KEY = OFF) ON [PRIMARY]
) ON [PRIMARY]
GO
/****** Object:  View [dbo].[VW_PRODUCTO_MAS_VENDIDO]    Script Date: 25/12/2020 15:49:37 ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
CREATE VIEW [dbo].[VW_PRODUCTO_MAS_VENDIDO]
AS
SELECT TOP 1 WITH TIES
	PRODUCTOS.UPC,
	PRODUCTOS.DESCRIPCION,
	COUNT(PRODUCTOS_X_VENTA.UPC) AS 'CANTIDAD VENDIDA'
FROM PRODUCTOS
INNER JOIN PRODUCTOS_X_VENTA ON PRODUCTOS_X_VENTA.UPC=PRODUCTOS.UPC
GROUP BY PRODUCTOS.UPC, PRODUCTOS.DESCRIPCION
ORDER BY [CANTIDAD VENDIDA]
GO
/****** Object:  View [dbo].[VW_PRODUCTOS_STOCKMIN]    Script Date: 25/12/2020 15:49:37 ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
CREATE VIEW [dbo].[VW_PRODUCTOS_STOCKMIN]
AS
SELECT *
FROM PRODUCTOS
WHERE PRODUCTOS.STOCK<=PRODUCTOS.STOCK_MIN
GO
/****** Object:  Table [dbo].[GRILLA]    Script Date: 25/12/2020 15:49:37 ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
CREATE TABLE [dbo].[GRILLA](
	[UPC] [bigint] NOT NULL,
	[CONTENEDOR] [int] NOT NULL,
	[ESTANTE] [char](1) NOT NULL
) ON [PRIMARY]
GO
/****** Object:  View [dbo].[VW_GRILLA]    Script Date: 25/12/2020 15:49:37 ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO

CREATE VIEW [dbo].[VW_GRILLA]
AS
SELECT * 
FROM GRILLA
GO
/****** Object:  Table [dbo].[PEDIDOS]    Script Date: 25/12/2020 15:49:37 ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
CREATE TABLE [dbo].[PEDIDOS](
	[ID] [int] IDENTITY(1,1) NOT NULL,
	[CUIT_PROVEEDOR] [varchar](50) NOT NULL,
	[UPC] [bigint] NOT NULL,
	[DESCRIPCION] [varchar](50) NOT NULL,
	[ID_COLOR] [int] NOT NULL,
	[ID_GENERO] [tinyint] NOT NULL,
	[CANTIDAD] [int] NOT NULL,
	[FECHA_INICIO] [date] NOT NULL,
	[FECHA_ENTREGA] [date] NULL,
	[ENTREGADO] [bit] NULL,
	[STOCK_MIN] [int] NULL,
	[ID_TALLE] [tinyint] NOT NULL,
PRIMARY KEY CLUSTERED 
(
	[ID] ASC
)WITH (PAD_INDEX = OFF, STATISTICS_NORECOMPUTE = OFF, IGNORE_DUP_KEY = OFF, ALLOW_ROW_LOCKS = ON, ALLOW_PAGE_LOCKS = ON, OPTIMIZE_FOR_SEQUENTIAL_KEY = OFF) ON [PRIMARY]
) ON [PRIMARY]
GO
/****** Object:  View [dbo].[VW_PEDIDOS_RECIBIDOS]    Script Date: 25/12/2020 15:49:37 ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
CREATE VIEW [dbo].[VW_PEDIDOS_RECIBIDOS]
AS
SELECT
	PEDIDOS.ID,
	PEDIDOS.CUIT_PROVEEDOR,
	PEDIDOS.FECHA_INICIO,
	PEDIDOS.FECHA_ENTREGA,
	PEDIDOS.CANTIDAD
FROM PEDIDOS
WHERE PEDIDOS.ENTREGADO=1
GO
/****** Object:  View [dbo].[VW_PEDIDOS]    Script Date: 25/12/2020 15:49:37 ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO

CREATE VIEW [dbo].[VW_PEDIDOS]
AS
SELECT
	PEDIDOS.ID,
	PEDIDOS.CUIT_PROVEEDOR,
	PEDIDOS.FECHA_INICIO,
	PEDIDOS.CANTIDAD
FROM PEDIDOS
WHERE PEDIDOS.ENTREGADO=0 OR PEDIDOS.ENTREGADO IS NULL
GO
/****** Object:  View [dbo].[VW_PRODUCTOS_DESENGRILLADOS]    Script Date: 25/12/2020 15:49:37 ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO

CREATE VIEW [dbo].[VW_PRODUCTOS_DESENGRILLADOS]
AS
SELECT *
FROM PRODUCTOS
WHERE PRODUCTOS.UPC NOT IN(
SELECT
VW_GRILLA.UPC
FROM VW_GRILLA
)
GO
/****** Object:  Table [dbo].[CANALES]    Script Date: 25/12/2020 15:49:37 ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
CREATE TABLE [dbo].[CANALES](
	[ID] [tinyint] IDENTITY(1,1) NOT NULL,
	[CANAL] [varchar](30) NOT NULL,
PRIMARY KEY CLUSTERED 
(
	[ID] ASC
)WITH (PAD_INDEX = OFF, STATISTICS_NORECOMPUTE = OFF, IGNORE_DUP_KEY = OFF, ALLOW_ROW_LOCKS = ON, ALLOW_PAGE_LOCKS = ON, OPTIMIZE_FOR_SEQUENTIAL_KEY = OFF) ON [PRIMARY],
UNIQUE NONCLUSTERED 
(
	[CANAL] ASC
)WITH (PAD_INDEX = OFF, STATISTICS_NORECOMPUTE = OFF, IGNORE_DUP_KEY = OFF, ALLOW_ROW_LOCKS = ON, ALLOW_PAGE_LOCKS = ON, OPTIMIZE_FOR_SEQUENTIAL_KEY = OFF) ON [PRIMARY]
) ON [PRIMARY]
GO
/****** Object:  Table [dbo].[COLORES]    Script Date: 25/12/2020 15:49:37 ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
CREATE TABLE [dbo].[COLORES](
	[ID] [int] IDENTITY(100,10) NOT NULL,
	[COLOR] [varchar](30) NOT NULL,
PRIMARY KEY CLUSTERED 
(
	[ID] ASC
)WITH (PAD_INDEX = OFF, STATISTICS_NORECOMPUTE = OFF, IGNORE_DUP_KEY = OFF, ALLOW_ROW_LOCKS = ON, ALLOW_PAGE_LOCKS = ON, OPTIMIZE_FOR_SEQUENTIAL_KEY = OFF) ON [PRIMARY],
UNIQUE NONCLUSTERED 
(
	[COLOR] ASC
)WITH (PAD_INDEX = OFF, STATISTICS_NORECOMPUTE = OFF, IGNORE_DUP_KEY = OFF, ALLOW_ROW_LOCKS = ON, ALLOW_PAGE_LOCKS = ON, OPTIMIZE_FOR_SEQUENTIAL_KEY = OFF) ON [PRIMARY]
) ON [PRIMARY]
GO
/****** Object:  Table [dbo].[GENEROS]    Script Date: 25/12/2020 15:49:37 ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
CREATE TABLE [dbo].[GENEROS](
	[ID] [tinyint] IDENTITY(1,1) NOT NULL,
	[GENERO] [varchar](30) NOT NULL,
PRIMARY KEY CLUSTERED 
(
	[ID] ASC
)WITH (PAD_INDEX = OFF, STATISTICS_NORECOMPUTE = OFF, IGNORE_DUP_KEY = OFF, ALLOW_ROW_LOCKS = ON, ALLOW_PAGE_LOCKS = ON, OPTIMIZE_FOR_SEQUENTIAL_KEY = OFF) ON [PRIMARY],
UNIQUE NONCLUSTERED 
(
	[GENERO] ASC
)WITH (PAD_INDEX = OFF, STATISTICS_NORECOMPUTE = OFF, IGNORE_DUP_KEY = OFF, ALLOW_ROW_LOCKS = ON, ALLOW_PAGE_LOCKS = ON, OPTIMIZE_FOR_SEQUENTIAL_KEY = OFF) ON [PRIMARY]
) ON [PRIMARY]
GO
/****** Object:  Table [dbo].[MEDIO_DE_PAGO]    Script Date: 25/12/2020 15:49:37 ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
CREATE TABLE [dbo].[MEDIO_DE_PAGO](
	[ID] [tinyint] IDENTITY(1,1) NOT NULL,
	[PAGO] [varchar](30) NOT NULL,
PRIMARY KEY CLUSTERED 
(
	[ID] ASC
)WITH (PAD_INDEX = OFF, STATISTICS_NORECOMPUTE = OFF, IGNORE_DUP_KEY = OFF, ALLOW_ROW_LOCKS = ON, ALLOW_PAGE_LOCKS = ON, OPTIMIZE_FOR_SEQUENTIAL_KEY = OFF) ON [PRIMARY],
UNIQUE NONCLUSTERED 
(
	[PAGO] ASC
)WITH (PAD_INDEX = OFF, STATISTICS_NORECOMPUTE = OFF, IGNORE_DUP_KEY = OFF, ALLOW_ROW_LOCKS = ON, ALLOW_PAGE_LOCKS = ON, OPTIMIZE_FOR_SEQUENTIAL_KEY = OFF) ON [PRIMARY]
) ON [PRIMARY]
GO
/****** Object:  Table [dbo].[POS]    Script Date: 25/12/2020 15:49:37 ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
CREATE TABLE [dbo].[POS](
	[POS] [int] IDENTITY(100,3) NOT NULL,
	[CAJA] [tinyint] NOT NULL,
PRIMARY KEY CLUSTERED 
(
	[POS] ASC
)WITH (PAD_INDEX = OFF, STATISTICS_NORECOMPUTE = OFF, IGNORE_DUP_KEY = OFF, ALLOW_ROW_LOCKS = ON, ALLOW_PAGE_LOCKS = ON, OPTIMIZE_FOR_SEQUENTIAL_KEY = OFF) ON [PRIMARY],
UNIQUE NONCLUSTERED 
(
	[CAJA] ASC
)WITH (PAD_INDEX = OFF, STATISTICS_NORECOMPUTE = OFF, IGNORE_DUP_KEY = OFF, ALLOW_ROW_LOCKS = ON, ALLOW_PAGE_LOCKS = ON, OPTIMIZE_FOR_SEQUENTIAL_KEY = OFF) ON [PRIMARY]
) ON [PRIMARY]
GO
/****** Object:  Table [dbo].[PROVEEDORES]    Script Date: 25/12/2020 15:49:37 ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
CREATE TABLE [dbo].[PROVEEDORES](
	[CUIT] [varchar](50) NOT NULL,
	[RAZON_SOCIAL] [varchar](50) NULL,
	[MAIL] [varchar](50) NOT NULL,
	[TELEFONO] [varchar](30) NOT NULL,
PRIMARY KEY CLUSTERED 
(
	[CUIT] ASC
)WITH (PAD_INDEX = OFF, STATISTICS_NORECOMPUTE = OFF, IGNORE_DUP_KEY = OFF, ALLOW_ROW_LOCKS = ON, ALLOW_PAGE_LOCKS = ON, OPTIMIZE_FOR_SEQUENTIAL_KEY = OFF) ON [PRIMARY],
UNIQUE NONCLUSTERED 
(
	[RAZON_SOCIAL] ASC
)WITH (PAD_INDEX = OFF, STATISTICS_NORECOMPUTE = OFF, IGNORE_DUP_KEY = OFF, ALLOW_ROW_LOCKS = ON, ALLOW_PAGE_LOCKS = ON, OPTIMIZE_FOR_SEQUENTIAL_KEY = OFF) ON [PRIMARY]
) ON [PRIMARY]
GO
/****** Object:  Table [dbo].[TALLES]    Script Date: 25/12/2020 15:49:37 ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
CREATE TABLE [dbo].[TALLES](
	[ID] [tinyint] IDENTITY(1,1) NOT NULL,
	[TALLE] [varchar](30) NOT NULL,
PRIMARY KEY CLUSTERED 
(
	[ID] ASC
)WITH (PAD_INDEX = OFF, STATISTICS_NORECOMPUTE = OFF, IGNORE_DUP_KEY = OFF, ALLOW_ROW_LOCKS = ON, ALLOW_PAGE_LOCKS = ON, OPTIMIZE_FOR_SEQUENTIAL_KEY = OFF) ON [PRIMARY],
UNIQUE NONCLUSTERED 
(
	[TALLE] ASC
)WITH (PAD_INDEX = OFF, STATISTICS_NORECOMPUTE = OFF, IGNORE_DUP_KEY = OFF, ALLOW_ROW_LOCKS = ON, ALLOW_PAGE_LOCKS = ON, OPTIMIZE_FOR_SEQUENTIAL_KEY = OFF) ON [PRIMARY]
) ON [PRIMARY]
GO
/****** Object:  Table [dbo].[TURNOS]    Script Date: 25/12/2020 15:49:37 ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
CREATE TABLE [dbo].[TURNOS](
	[ID] [tinyint] IDENTITY(1,1) NOT NULL,
	[TURNO] [varchar](2) NOT NULL,
PRIMARY KEY CLUSTERED 
(
	[ID] ASC
)WITH (PAD_INDEX = OFF, STATISTICS_NORECOMPUTE = OFF, IGNORE_DUP_KEY = OFF, ALLOW_ROW_LOCKS = ON, ALLOW_PAGE_LOCKS = ON, OPTIMIZE_FOR_SEQUENTIAL_KEY = OFF) ON [PRIMARY],
UNIQUE NONCLUSTERED 
(
	[TURNO] ASC
)WITH (PAD_INDEX = OFF, STATISTICS_NORECOMPUTE = OFF, IGNORE_DUP_KEY = OFF, ALLOW_ROW_LOCKS = ON, ALLOW_PAGE_LOCKS = ON, OPTIMIZE_FOR_SEQUENTIAL_KEY = OFF) ON [PRIMARY]
) ON [PRIMARY]
GO
/****** Object:  Table [dbo].[VENDEDORES]    Script Date: 25/12/2020 15:49:37 ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
CREATE TABLE [dbo].[VENDEDORES](
	[LEGAJO] [int] IDENTITY(1,1) NOT NULL,
	[NOMBRE] [varchar](50) NOT NULL,
	[APELLIDO] [varchar](50) NOT NULL,
	[DNI] [varchar](11) NOT NULL,
	[MAIL] [varchar](50) NOT NULL,
	[TELEFONO] [varchar](30) NOT NULL,
	[FECHA_NAC] [date] NOT NULL,
	[ID_TURNO] [tinyint] NOT NULL,
PRIMARY KEY CLUSTERED 
(
	[LEGAJO] ASC
)WITH (PAD_INDEX = OFF, STATISTICS_NORECOMPUTE = OFF, IGNORE_DUP_KEY = OFF, ALLOW_ROW_LOCKS = ON, ALLOW_PAGE_LOCKS = ON, OPTIMIZE_FOR_SEQUENTIAL_KEY = OFF) ON [PRIMARY]
) ON [PRIMARY]
GO
/****** Object:  Table [dbo].[VENTAS]    Script Date: 25/12/2020 15:49:37 ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
CREATE TABLE [dbo].[VENTAS](
	[ID] [bigint] IDENTITY(1,1) NOT NULL,
	[ID_CANAL] [tinyint] NOT NULL,
	[ID_MEDIODEPAGOS] [tinyint] NOT NULL,
	[FECHA] [date] NOT NULL,
	--[MONTO_TOTAL] [money] NOT NULL,
	[POS] [int] NOT NULL,
	[LEGAJO_VENDEDOR] [int] NOT NULL,
PRIMARY KEY CLUSTERED 
(
	[ID] ASC
)WITH (PAD_INDEX = OFF, STATISTICS_NORECOMPUTE = OFF, IGNORE_DUP_KEY = OFF, ALLOW_ROW_LOCKS = ON, ALLOW_PAGE_LOCKS = ON, OPTIMIZE_FOR_SEQUENTIAL_KEY = OFF) ON [PRIMARY]
) ON [PRIMARY]
GO
ALTER TABLE [dbo].[GRILLA]  WITH CHECK ADD FOREIGN KEY([UPC])
REFERENCES [dbo].[PRODUCTOS] ([UPC])
GO
ALTER TABLE [dbo].[PEDIDOS]  WITH CHECK ADD FOREIGN KEY([CUIT_PROVEEDOR])
REFERENCES [dbo].[PROVEEDORES] ([CUIT])
GO
ALTER TABLE [dbo].[PEDIDOS]  WITH CHECK ADD FOREIGN KEY([ID_COLOR])
REFERENCES [dbo].[COLORES] ([ID])
GO
ALTER TABLE [dbo].[PEDIDOS]  WITH CHECK ADD FOREIGN KEY([ID_GENERO])
REFERENCES [dbo].[GENEROS] ([ID])
GO
ALTER TABLE [dbo].[PEDIDOS]  WITH CHECK ADD FOREIGN KEY([ID_TALLE])
REFERENCES [dbo].[TALLES] ([ID])
GO
ALTER TABLE [dbo].[PEDIDOS]  WITH CHECK ADD FOREIGN KEY([UPC])
REFERENCES [dbo].[PRODUCTOS] ([UPC])
GO
ALTER TABLE [dbo].[PRODUCTOS]  WITH CHECK ADD FOREIGN KEY([ID_COLOR])
REFERENCES [dbo].[COLORES] ([ID])
GO
ALTER TABLE [dbo].[PRODUCTOS]  WITH CHECK ADD FOREIGN KEY([ID_GENERO])
REFERENCES [dbo].[GENEROS] ([ID])
GO
ALTER TABLE [dbo].[PRODUCTOS]  WITH CHECK ADD FOREIGN KEY([ID_TALLE])
REFERENCES [dbo].[TALLES] ([ID])
GO
ALTER TABLE [dbo].[PRODUCTOS_X_VENTA]  WITH CHECK ADD FOREIGN KEY([ID_VENTA])
REFERENCES [dbo].[VENTAS] ([ID])
GO
ALTER TABLE [dbo].[PRODUCTOS_X_VENTA]  WITH CHECK ADD FOREIGN KEY([UPC])
REFERENCES [dbo].[PRODUCTOS] ([UPC])
GO
ALTER TABLE [dbo].[VENDEDORES]  WITH CHECK ADD FOREIGN KEY([ID_TURNO])
REFERENCES [dbo].[TURNOS] ([ID])
GO
ALTER TABLE [dbo].[VENTAS]  WITH CHECK ADD FOREIGN KEY([ID_CANAL])
REFERENCES [dbo].[CANALES] ([ID])
GO
ALTER TABLE [dbo].[VENTAS]  WITH CHECK ADD FOREIGN KEY([ID_MEDIODEPAGOS])
REFERENCES [dbo].[MEDIO_DE_PAGO] ([ID])
GO
ALTER TABLE [dbo].[VENTAS]  WITH CHECK ADD FOREIGN KEY([LEGAJO_VENDEDOR])
REFERENCES [dbo].[VENDEDORES] ([LEGAJO])
GO
ALTER TABLE [dbo].[VENTAS]  WITH CHECK ADD FOREIGN KEY([POS])
REFERENCES [dbo].[POS] ([POS])
GO
ALTER TABLE [dbo].[PEDIDOS]  WITH CHECK ADD CHECK  (([CANTIDAD]>(0)))
GO
ALTER TABLE [dbo].[PEDIDOS]  WITH CHECK ADD CHECK  (([STOCK_MIN]>(0)))
GO
ALTER TABLE [dbo].[PRODUCTOS]  WITH CHECK ADD CHECK  (([PRECIO]>(0)))
GO
ALTER TABLE [dbo].[PRODUCTOS]  WITH CHECK ADD CHECK  (([STOCK]>(0)))
GO
ALTER TABLE [dbo].[PRODUCTOS]  WITH CHECK ADD CHECK  (([STOCK_MIN]>(0)))
GO
ALTER TABLE [dbo].[PRODUCTOS_X_VENTA]  WITH CHECK ADD CHECK  (([PRECIO_UNITARIO]>(0)))
GO
--ALTER TABLE [dbo].[VENTAS]  WITH CHECK ADD CHECK  (([MONTO_TOTAL]>(0)))
GO
/****** Object:  StoredProcedure [dbo].[SP_ENGRILLAR]    Script Date: 25/12/2020 15:49:37 ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
CREATE PROCEDURE [dbo].[SP_ENGRILLAR](
@UPC BIGINT,
@CONTENEDOR INT,
@ESTANTE CHAR(1))
AS
BEGIN
INSERT INTO GRILLA(UPC, CONTENEDOR, ESTANTE) VALUES (@UPC, @CONTENEDOR, @ESTANTE)
END
GO
/****** Object:  StoredProcedure [dbo].[SP_INSERTAR_PROVEEDOR]    Script Date: 25/12/2020 15:49:37 ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
CREATE PROCEDURE [dbo].[SP_INSERTAR_PROVEEDOR](
	@CUIT VARCHAR(50), 
	@RAZON_SOCIAL VARCHAR(50), 
	@MAIL VARCHAR(50), 
	@TELEFONO VARCHAR(30)
)
AS
BEGIN
INSERT INTO PROVEEDORES(CUIT, RAZON_SOCIAL, MAIL, TELEFONO) VALUES (@CUIT, @RAZON_SOCIAL, @MAIL, @TELEFONO)
END
GO
/****** Object:  StoredProcedure [dbo].[SP_INSERTAR_VENDEDOR]    Script Date: 25/12/2020 15:49:37 ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
CREATE PROCEDURE [dbo].[SP_INSERTAR_VENDEDOR](
@LEGAJO INT,
@NOMBRE VARCHAR(50),
@APELLIDO VARCHAR(50),
@DNI VARCHAR(11),
@MAIL VARCHAR(50),
@TELEFONO VARCHAR(30),
@FECHA_NAC DATE,
@ID_TURNO TINYINT
)
AS
BEGIN
INSERT INTO VENDEDORES (NOMBRE, APELLIDO, DNI, MAIL, TELEFONO, FECHA_NAC, ID_TURNO) VALUES(@NOMBRE, @APELLIDO, @DNI, @MAIL, @TELEFONO, @FECHA_NAC, @ID_TURNO)
END
GO
/****** Object:  StoredProcedure [dbo].[SP_VENDEDOR_X_TURNO]    Script Date: 25/12/2020 15:49:37 ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
CREATE PROCEDURE [dbo].[SP_VENDEDOR_X_TURNO] (
@TURNO VARCHAR(2)
)
AS
BEGIN
SELECT
	V.LEGAJO,
	V.NOMBRE+ ' '+ V.APELLIDO AS 'APENOM',
	T.TURNO
FROM VENDEDORES AS V
INNER JOIN TURNOS AS T ON V.ID_TURNO=T.ID
WHERE T.TURNO=@TURNO
END
GO
USE [master]
GO
ALTER DATABASE [BACK OF HOUSE] SET  READ_WRITE 
GO
